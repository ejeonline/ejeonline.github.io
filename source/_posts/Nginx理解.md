---
title: Nginx理解
date: 2019-04-01 10:34:53
tags:
  - 环境搭建
toc: true
type:
categories:
  - 环境搭建
comments: true
---

### 代理介绍

　　在Java设计模式中，代理模式是这样定义的：给某个对象提供一个代理对象，并由代理对象控制原对象的引用。代理简单来说，就是如果我们想做什么，但又不想直接去做，那么这时候就找另外一个人帮我们去做。比如中介公司就是给我们做代理服务的，我们委托中介公司帮我们找房子。　

<!--more-->　
	Nginx 主要能够代理如下几种协议，其中用到的最多的就是做Http代理服务器。

![img](Nginx理解/1120165-20180905232339438-913760288.png)

### 正向代理

​	VPN 就是做正向代理的。正向代理服务器位于客户端和服务器之间，为了向服务器获取数据，客户端要向代理服务器发送一个请求，并指定目标服务器，代理服务器将目标服务器返回的数据转交给客户端。这里客户端是要进行一些正向代理的设置的。

​	什么是 VPN，VPN 通俗的讲就是一种中转服务，当我们电脑接入 VPN 后，我们对外 IP 地址就会变成 VPN 服务器的 公网 IP，我们请求或接受任何数据都会通过这个VPN 服务器然后传入到我们本机。这样做有什么好处呢？比如 VPN 游戏加速方面的原理，我们要玩网通区的 LOL，但是本机接入的是电信的宽带，玩网通区的会比较卡，这时候就利用 VPN 将电信网络变为网通网络，然后在玩网通区的LOL就不会卡了（注意：VPN 是不能增加带宽的，不要以为不卡了是因为网速提升了）。

　　理解这两种代理的关键在于代理服务器所代理的对象是什么，正向代理代理的是客户端，我们需要在客户端进行一些代理的设置。而反向代理代理的是服务器，作为客户端的我们是无法感知到服务器的真实存在的。
	反向代理和正向代理的区别就是：**正向代理代理客户端，反向代理代理服务器。**

### 反向代理

e.g 使用 nginx 反向代理 www.123.com 直接跳转到127.0.0.1:8080
步骤:启动一个 tomcat，浏览器地址栏输入 127.0.0.1:8080
通过修改本地 host 文件，将 www.123.com 映射到 127.0.0.1

```
127.0.0.1 www.123.com
```

配置完成之后，我们便可以通过 www.123.com:8080 访问到第一步出现的 Tomcat初始界面。		
如何只需要输入 www.123.com 便可以跳转到 Tomcat初始界面呢？便用到 nginx的反向代理。

在 nginx.conf 配置文件中增加如下配置：

    server {
    		listen       80;
    		server_name  www.123.com;
    		location / {
    		proxy_pass http://127.0.0.1:8080;
    		index  index.html index.htm index.jsp;
        }
    }
​	如上配置，我们监听80端口，访问域名为www.123.com，不加端口号时默认为80端口，故访问该域名时会跳转到127.0.0.1:8080路径上。
我们在浏览器端输入 www.123.com 结果如下：

![img](Nginx理解/1120165-20180906073551600-75534434.png)

总结：其实这里更贴切的说是通过nginx代理端口，原先访问8080端口，通过nginx代理之后，通过80端口就可以访问了。

